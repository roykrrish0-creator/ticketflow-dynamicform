// Use our custom Azure-themed Material Design system
@use './theme.scss';

// Tailwind CSS imports (after Material theme)
@tailwind base;
@tailwind components;
@tailwind utilities;

// Material Design components will automatically use theme tokens
// Only keep essential fixes for Tailwind conflicts

// Essential custom properties for backwards compatibility
:root {
  // Primary brand color aliases (backwards compatibility)
  --primary-blue: #005ac2;
  --primary-blue-light: #adc6ff;
  --primary-blue-dark: #004395;
  
  // Semantic colors
  --color-success: #22c55e;
  --color-warning: #f59e0b;
  --color-error: #ef4444;
  --color-info: #3b82f6;
  
  // Background colors
  --bg-primary: #fcf8f9;
  --bg-secondary: #f6f3f3;
  --bg-surface: #ffffff;
  --bg-section: #f6f3f3; // surface-container-low
  --bg-elevated: #ffffff;
  --bg-card: #ffffff;
  --bg-input: #ffffff;
  --bg-hover: #f8fafc;
  --bg-selected: #e0e7ff;
  
  // Text colors
  --text-primary: #1c1b1c;
  --text-secondary: #6b7280;
  --text-tertiary: #9ca3af;
  --text-disabled: #d1d5db;
  --text-inverse: #ffffff;
  --text-accent: var(--primary-blue);
  --text-success: #059669;
  --text-warning: #d97706;
  --text-error: #dc2626;
  --text-info: #2563eb;
  
  // Border colors
  --border-default: #e5e7eb;
  --border-light: #f3f4f6;
  --border-medium: #d1d5db;
  --border-dark: #9ca3af;
  --border-accent: var(--primary-blue);
  --border-focus: var(--primary-blue);
  --border-success: #22c55e;
  --border-warning: #f59e0b;
  --border-error: #ef4444;
  --border-info: #3b82f6;
  
  // Status colors
  --status-submitted: #17a2b8;
  --status-new: #007bff;
  --status-assigned: #fd7e14;
  --status-in-progress: #ffc107;
  --status-manual_review: #20c997;
  --status-completed: #28a745;
  --status-closed: #343a40;
  --status-failed: #dc3545;
  --status-reopened: #fd7e14;

  // Status Text Colors
  --status-submitted-text: #fff;
  --status-new-text: #fff;
  --status-assigned-text: rgba(0,0,0,0.87);
  --status-in-progress-text: rgba(0,0,0,0.87);
  --status-manual_review-text: #fff;
  --status-completed-text: #fff;
  --status-closed-text: #fff;
  --status-failed-text: #fff;
  --status-reopened-text: rgba(0,0,0,0.87);

  
  // Priority colors
  --priority-urgent: #dc3545;
  --priority-high: #fd7e14;
  --priority-medium: #ffc107;
  --priority-low: #28a745;
  
  // Component-specific colors
  --button-primary: var(--primary-blue);
  --button-secondary: #f8fafc;
  --button-success: var(--color-success);
  --button-warning: var(--color-warning);
  --button-danger: var(--color-error);
  
  // Comment colors
  --comment-bg: #f9fafb;
  --comment-border: var(--border-default);
  --comment-author: #374151;
  --comment-time: var(--text-secondary);
  --comment-internal-bg: #fef3c7;
  
  // Shadow colors
  --shadow-sm: rgba(0, 0, 0, 0.05);
  --shadow-md: rgba(0, 0, 0, 0.1);
  --shadow-lg: rgba(0, 0, 0, 0.15);
  --shadow-xl: rgba(0, 0, 0, 0.25);
  
  // Overlay colors
  --overlay-bg: rgba(0, 0, 0, 0.6);
  --backdrop-blur: rgba(0, 0, 0, 0.5);
  
  // Legacy spacing aliases for existing components
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  --spacing-md: 1rem;
  
  // Component-specific tokens
  --radius-sm: 0.25rem;
  --radius-md: 0.375rem;
  --radius-lg: 0.5rem;
  --radius-xl: 0.75rem;
  
  // Material Design z-index values
  --z-dropdown: 1000;
  --z-modal: 1050;
  --z-tooltip: 1100;
  --z-overlay: 1200;
}

// Essential global styles (Tailwind provides the rest)
html, body {
  font-family: Roboto, sans-serif;
}

app-root {
  min-height: 100vh;
}

// Custom utilities not available in Tailwind
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

// Status badges are now defined in theme.scss using Material Design tokens

// Focus styles for accessibility
.focus-outline:focus,
.focus-outline:focus-visible {
  @apply ring-2 ring-blue-500 ring-offset-2;
}

// Fix icon sizing for all Material components
.mat-mdc-menu-item {
  mat-icon {
    font-size: 18px !important;
    width: 18px !important;
    height: 18px !important;
    margin-right: 0.5rem !important;
  }
}

// Fix tab label icons
.mat-mdc-tab-label {
  mat-icon {
    font-size: 18px !important;
    width: 18px !important;
    height: 18px !important;
    margin-right: 0.5rem !important;
  }
}

// Fix any remaining icon issues globally
mat-icon {
  font-family: 'Material Icons' !important;
  font-weight: normal !important;
  font-style: normal !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  letter-spacing: normal !important;
  text-transform: none !important;
  white-space: nowrap !important;
  word-wrap: normal !important;
  direction: ltr !important;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  -moz-osx-font-smoothing: grayscale;
  font-feature-settings: 'liga';
}


// Helper function: calculate brightness
@function color-brightness($color) {
  $r: red($color);
  $g: green($color);
  $b: blue($color);

  // W3C recommended luminance formula
  @return (($r * 299) + ($g * 587) + ($b * 114)) / 1000;
}

// Helper function: return white or dark text
@function text-color-based-on-bg($color) {
  @if (color-brightness($color) > 150) {
    @return rgba(0, 0, 0, 0.87); // dark text for light backgrounds
  } @else {
    @return #fff; // white text for dark backgrounds
  }
}

// Mixin: apply background + computed text color
@mixin pill-color($bg-color) {
  background-color: $bg-color;
  color: text-color-based-on-bg($bg-color);
  border-radius: 9999px; // pill shape
  font-weight: 500;
  padding: 4px 12px;
}
@mixin pill-color($bg-color) {
  background-color: $bg-color;
  color: text-color-based-on-bg($bg-color);
  border-radius: 9999px; // pill shape
  font-weight: 500;
  padding: 4px 12px;
}
